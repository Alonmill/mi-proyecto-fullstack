<div class="container">
  <h2>Ver Expediente Médico</h2>

  <div class="search-card">
    <h3>Buscar expediente por paciente</h3>

    <label for="pacienteSelect">Paciente:</label>
    <select id="pacienteSelect" [(ngModel)]="idBuscar">
      <option [ngValue]="null" disabled selected>Selecciona un paciente...</option>
      <option *ngFor="let exp of expedientesDisponibles" [ngValue]="exp.id">
        {{ exp.nombrePaciente }}
      </option>
    </select>

    <button (click)="buscar()" [disabled]="!idBuscar || cargandoExpedientes">Buscar</button>

    <small *ngIf="cargandoExpedientes">Cargando pacientes...</small>
  </div>

  <div *ngIf="expediente" class="card">
    <h3>Paciente: {{ expediente.nombrePaciente }}</h3>
    <p><strong>ID:</strong> {{ expediente.id }}</p>
    <p><strong>Número Identificación:</strong> {{ expediente.numeroIdentificacion }}</p>
    <p><strong>Fecha Nacimiento:</strong> {{ expediente.fechaNacimiento }}</p>

    <h3>Entradas del Historial</h3>
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Diagnóstico</th>
          <th>Tratamiento</th>
          <th>Médico</th>
          <th>Estado Cita</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entrada of expediente.entradasHistorial">
          <td>{{ entrada.id }}</td>
          <td>{{ entrada.fecha }}</td>
          <td>{{ entrada.hora }}</td>
          <td>{{ entrada.diagnostico }}</td>
          <td>{{ entrada.tratamiento }}</td>
          <td>{{ entrada.nombreMedico }}</td>
          <td>{{ entrada.estadoCita }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <p *ngIf="error" class="text-danger">{{ error }}</p>
</div>
