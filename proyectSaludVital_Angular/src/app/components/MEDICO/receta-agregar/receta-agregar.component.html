<h2>Nueva Receta</h2>

<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <div *ngIf="mensajeError" class="alert-error">
    {{ mensajeError }}
  </div>

  <div formArrayName="items">
    <div *ngFor="let item of items.controls; let i = index" [formGroupName]="i" class="item-card">
      <label>Medicamento:</label>
      <ng-select
        [items]="medicamentos"
        bindLabel="nombre"
        bindValue="id"
        formControlName="medicamentoId"
        [searchable]="true"
        [clearable]="true"
        placeholder="Buscar medicamento..."
        notFoundText="No se encontraron medicamentos"
      >
      </ng-select>

      <label>Dosis:</label>
      <input type="text" formControlName="dosis">

      <label>Frecuencia:</label>
      <input type="text" formControlName="frecuencia">

      <button type="button" (click)="eliminarItem(i)">Eliminar</button>
    </div>
  </div>

  <button type="button" (click)="agregarItem()">+ Agregar Medicamento</button>
  <button type="submit">Guardar Receta</button>
</form>
