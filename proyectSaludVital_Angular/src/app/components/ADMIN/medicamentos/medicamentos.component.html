<div class="medicamentos-page">
  <h2>Gestión de Medicamentos</h2>

  <div class="cards-grid">
    <section class="section-card" *ngIf="usuario?.rol === 'ADMIN'">
      <h3>{{ isEditMode ? 'Editar medicamento' : 'Registrar medicamento' }}</h3>

      <form [formGroup]="medicamentoForm" (ngSubmit)="onSubmit()" class="med-form">
        <div class="field">
          <label for="nombre">Nombre</label>
          <input type="text" id="nombre" class="form-control" formControlName="nombre" />
          <div *ngIf="medicamentoForm.get('nombre')?.touched && medicamentoForm.get('nombre')?.invalid" class="text-danger">
            <small *ngIf="medicamentoForm.get('nombre')?.errors?.['required']">El nombre es obligatorio.</small>
            <small *ngIf="medicamentoForm.get('nombre')?.errors?.['minlength']">Mínimo 3 caracteres.</small>
            <small *ngIf="medicamentoForm.get('nombre')?.errors?.['maxlength']">Máximo 50 caracteres.</small>
          </div>
        </div>

        <div class="field">
          <label for="descripcion">Descripción</label>
          <textarea id="descripcion" class="form-control" formControlName="descripcion"></textarea>
          <div *ngIf="medicamentoForm.get('descripcion')?.touched && medicamentoForm.get('descripcion')?.invalid" class="text-danger">
            <small *ngIf="medicamentoForm.get('descripcion')?.errors?.['required']">La descripción es obligatoria.</small>
            <small *ngIf="medicamentoForm.get('descripcion')?.errors?.['minlength']">Mínimo 5 caracteres.</small>
            <small *ngIf="medicamentoForm.get('descripcion')?.errors?.['maxlength']">Máximo 200 caracteres.</small>
          </div>
        </div>

        <div class="actions-row">
          <button type="submit" class="btn btn-primary">{{ isEditMode ? 'Actualizar' : 'Registrar' }}</button>
          <button type="button" class="btn btn-secondary" (click)="resetForm()">Cancelar</button>
        </div>
      </form>
    </section>

    <section class="section-card list-card">
      <h3>Listado de Medicamentos</h3>
      <div class="table-wrapper">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>ID</th>
              <th>Nombre</th>
              <th>Descripción</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let med of medicamentos">
              <td>{{ med.id }}</td>
              <td>{{ med.nombre }}</td>
              <td>{{ med.descripcion }}</td>
              <td>
                <div class="table-actions">
                  <button class="btn btn-sm btn-warning" (click)="editarMedicamento(med)">Editar</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>
  </div>
</div>
